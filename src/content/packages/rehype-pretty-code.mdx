---
title: "rehype-pretty-code"
---

[`rehype-pretty-code`](https://github.com/atomiks/rehype-pretty-code)æ˜¯`Rehype`æ’ä»¶ç”±[`shiki`](https://github.com/shikijs/shiki)æä¾›è¯­æ³•é«˜äº®èƒ½åŠ›ï¼Œä¸º Markdown æˆ– MDX æä¾›æ¼‚äº®çš„ä»£ç å—ã€‚å®ƒæ—¢é€‚ç”¨äºæ„å»ºæ—¶çš„æœåŠ¡å™¨ï¼ˆé¿å…è¿è¡Œæ—¶è¯­æ³•é«˜äº®æ˜¾ç¤ºï¼‰ï¼Œä¹Ÿé€‚ç”¨äºåŠ¨æ€é«˜äº®æ˜¾ç¤ºçš„å®¢æˆ·ç«¯ã€‚

## ç¼–è¾‘å™¨å¡åº¦é«˜äº®æ˜¾ç¤º

äº«å— VS Code è¯­æ³•é«˜äº®å¼•æ“çš„å‡†ç¡®æ€§å’Œç²’åº¦ï¼Œä»¥åŠå…¶ä¸»é¢˜ç”Ÿæ€ç³»ç»Ÿçš„å—æ¬¢è¿ç¨‹åº¦â€”â€”ä½¿ç”¨æ‚¨æƒ³è¦çš„ä»»ä½• VS Code ä¸»é¢˜ï¼

## è¡Œå·å’Œçº¿æ¡é«˜äº®æ˜¾ç¤º

è¯·æ³¨æ„ç‰¹å®šçš„ä»£ç è¡Œã€‚

```js {4} showLineNumbers
import { useFloating } from "@floating-ui/react";

function MyComponent() {
  const { refs, floatingStyles } = useFloating();

  return (
    <>
      <div ref={refs.setReference} />
      <div ref={refs.setFloating} style={floatingStyles} />
    </>
  );
}
```

## å•è¯çªå‡ºæ˜¾ç¤º

å¼•èµ·äººä»¬å¯¹æŸä¸ªç‰¹å®šå•è¯æˆ–ä¸€ç³»åˆ—å­—ç¬¦çš„æ³¨æ„ã€‚

```js /floatingStyles/
import { useFloating } from "@floating-ui/react";

function MyComponent() {
  const { refs, floatingStyles } = useFloating();

  return (
    <>
      <div ref={refs.setReference} />
      <div ref={refs.setFloating} style={floatingStyles} />
    </>
  );
}
```

## å†…è”ä»£ç çªå‡ºæ˜¾ç¤º

`[1, 2, 3].join('-'){:js}` çš„ç»“æœæ˜¯ `'1-2-3'{:js}`.

### ä¸Šä¸‹æ–‡æ„ŸçŸ¥å†…è”ä»£ç 

ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æœ‰ä»¥ä¸‹ä»£ç å—:

```js
function getStringLength(str) {
  return str.length;
}
```

å½“æˆ‘ä»¬å°†`getStringLength{:.entity.name.function}`ç§°ä¸ºæ™®é€šå˜é‡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ç€è‰²ä¸ºå‡½æ•°ã€‚
ä¸`function{:.keyword}`, æˆ– `str{:.variable.parameter}` vs. `str{:.variable.other.object}`ç­‰ç›¸åŒã€‚
è¿™å…è®¸æ‚¨åœ¨è¯­ä¹‰ä¸Šå°†å†…è”ä»£ç ä¸å®ƒæ‰€å¼•ç”¨çš„æœ€è¿‘çš„ä»£ç å—è”ç³»èµ·æ¥ã€‚

## ANSI é«˜äº®æ˜¾ç¤º

```ansi
[0;36m  vite v5.0.0[0;32m dev server running at:[0m

  > Local: [0;36mhttp://localhost:[0;36;1m3000[0;36m/[0m
  > Network: [0;2muse `--host` to expose[0m

  [0;36mready in 125ms.[0m

[0;2m8:38:02 PM[0m [0;36;1m[vite][0m [0;32mhmr update [0;2m/src/App.jsx
```

å†…è” ANSI: `> Local: [0;36mhttp://localhost:[0;36;1m3000[0;36m/[0m{:ansi}`

## å®‰è£…

é€šè¿‡æ‚¨çš„ç»ˆç«¯å®‰è£…:

```shell
npm install rehype-pretty-code shiki
```

æ­¤ç¨‹åºåŒ…ä»…é™ ESMï¼Œç›®å‰æ”¯æŒ `shiki{:.string}` `^1.0.0{:.string}`.

> è¦åœ¨ Next.js ä¸­ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ï¼Œè¯·ç¡®ä¿æ‚¨çš„é…ç½®æ–‡ä»¶ `ESM`:
> `next.config.mjs`. è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­:
> [rehype-pretty-code/website/next.config.mjs](https://github.com/atomiks/rehype-pretty-code/blob/master/website/next.config.mjs)

## ç”¨æ³•

ä»¥ä¸‹æ“ä½œæ—¢é€‚ç”¨äºæœåŠ¡å™¨ï¼Œä¹Ÿé€‚ç”¨äºå®¢æˆ·ç«¯ã€‚

```js /rehypePrettyCode/
import { unified } from "unified";
import remarkParse from "remark-parse";
import remarkRehype from "remark-rehype";
import rehypeStringify from "rehype-stringify";
import rehypePrettyCode from "rehype-pretty-code";

async function main() {
  const file = await unified()
    .use(remarkParse)
    .use(remarkRehype)
    .use(rehypePrettyCode, {
      // See Options section below.
    })
    .use(rehypeStringify)
    .process("`const numbers = [1, 2, 3]{:js}`");

  console.log(String(file));
}

main();
```

è¯·æ³¨æ„ `unified{:.string}` **v11** åœ¨å†…éƒ¨ç”¨ä½œä¾èµ–é¡¹ã€‚
ç¡®ä¿æ‚¨çš„ `unified{:.string}` ç‰ˆæœ¬å…¼å®¹ã€‚

### MDX

ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†å¦‚ä½•å°†æ­¤åŒ…ä¸ Next.js ä¸€èµ·ä½¿ç”¨ã€‚

```js title="next.config.mjs"
import fs from "node:fs";
import nextMDX from "@next/mdx";
import rehypePrettyCode from "rehype-pretty-code";

/** @type {import('rehype-pretty-code').Options} */
const options = {
  // See Options section below.
};

const withMDX = nextMDX({
  extension: /\.mdx?$/,
  options: {
    remarkPlugins: [],
    rehypePlugins: [[rehypePrettyCode, options]],
  },
});

/** @type {import('next').NextConfig} */
const nextConfig = { reactStrictMode: true };

export default withMDX(nextConfig);
```

å¦‚æœ Rehype æ’ä»¶ä¸èµ·ä½œç”¨ï¼Œè¯·ç¦ç”¨`mdxRs{:.meta.object-literal.key}`é€‰é¡¹ã€‚

## æ ·å¼

æ­¤åº“å·²å–æ¶ˆæ ·å¼ã€‚è¿™æ„å‘³ç€å®ƒä¸æä¾›é»˜è®¤æƒ…å†µä¸‹åº”ç”¨æ ·å¼çš„ CSS æ–‡ä»¶ã€‚ç›¸åï¼Œå®ƒæä¾›äº†ç”¨äºè‡ªå·±åº”ç”¨æ ·å¼çš„é€»è¾‘å±æ€§ã€‚

ä¾‹å¦‚ï¼Œä»¥ä¸‹ CSS å¯é˜²æ­¢æº¢å‡ºå¹¶æ·»åŠ å¡«å……ï¼š

```css
pre {
  overflow-x: auto;
  padding: 1rem 0;
}

pre [data-line] {
  padding: 0 1rem;
}
```

åŒ…æ‹¬é«˜äº®æ˜¾ç¤ºçš„è¡Œã€å­—ç¬¦å’Œè¡Œå·åœ¨å†…çš„åŠŸèƒ½å…¬å¼€äº†æ•°æ®å±æ€§ï¼Œä½¿æ‚¨èƒ½å¤Ÿæ·»åŠ è‡ªå·±çš„æ ·å¼ï¼Œå¦‚ä¸‹æ‰€è¿°ã€‚

## é€‰é¡¹

```ts
interface Options {
  grid?: boolean;
  theme?: Theme | Record<string, Theme>;
  keepBackground?: boolean;
  defaultLang?: string | { block?: string; inline?: string };
  tokensMap?: Record<string, string>;
  transformers?: ShikiTransformer[];
  filterMetaString?(str: string): string;
  getHighlighter?(options: BundledHighlighterOptions): Promise<Highlighter>;
  onVisitLine?(element: LineElement): void;
  onVisitHighlightedLine?(element: LineElement): void;
  onVisitHighlightedChars?(element: CharsElement, id: string | undefined): void;
  onVisitTitle?(element: Element): void;
  onVisitCaption?(element: Element): void;
}
```

### `grid{:.meta.object-literal.key}`

é»˜è®¤æƒ…å†µä¸‹ä¼šå‡ºç°ç½‘æ ¼æ ·å¼ï¼Œå®ƒå…è®¸è¡Œé«˜äº®æ˜¾ç¤ºè·¨è¶Šæ°´å¹³æ»šåŠ¨ä»£ç å—çš„æ•´ä¸ªå®½åº¦ã€‚

å¦‚æœ‰å¿…è¦ï¼Œå¯ä»¥ç¦ç”¨æ­¤è®¾ç½®:

```js
const options = {
  grid: false,
};
```

### `theme{:.meta.object-literal.key}`

é»˜è®¤ä¸»é¢˜ä¸º `github-dark-dimmed{:.string}`. Shiki æœ‰ä¸€å †[é¢„å…ˆåŒ…è£…å¥½çš„ä¸»é¢˜](https://shiki.style/themes#themes), å¯ä»¥æŒ‡å®šä¸ºçº¯å­—ç¬¦ä¸²:

```js
const options = {
  theme: "one-dark-pro",
};
```

æ‚¨ä¹Ÿå¯ä»¥é€šè¿‡ä¼ é€’ä¸»é¢˜ JSON æ¥ä½¿ç”¨è‡ªå·±çš„ä¸»é¢˜ï¼š

```js
const options = {
  theme: JSON.parse(fs.readFileSync("./themes/moonlight-ii.json", "utf-8")),
};
```

### `keepBackground{:.meta.object-literal.key}`

è¦åº”ç”¨è‡ªå®šä¹‰èƒŒæ™¯è€Œä¸æ˜¯ä»ä¸»é¢˜ç»§æ‰¿èƒŒæ™¯ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

```js
const options = {
  keepBackground: false,
};
```

### `defaultLang{:.meta.object-literal.key}`

å½“æ²¡æœ‰æŒ‡å®šä»£ç è¯­è¨€æ—¶ï¼Œå†…è”ä»£ç æˆ–ä»£ç å—å°†ä¸ä¼šè¢«è®¾ç½®ä¸»é¢˜ï¼ˆèƒŒæ™¯ä¹Ÿä¸ä¼šï¼‰ï¼Œè¿™å¯èƒ½ä¼šæ˜¾å¾—ä¸å…¶ä»–ä»£ç ä¸åè°ƒã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥æŒ‡å®šé»˜è®¤è¯­è¨€:

```js
const options = {
  defaultLang: "plaintext",
};
```

æˆ–è€…ï¼Œæ‚¨ä¹Ÿå¯ä»¥åˆ†åˆ«ä¸ºå†…è”ä»£ç å’Œä»£ç å—æŒ‡å®šé»˜è®¤è¯­è¨€:

```js
const options = {
  defaultLang: {
    block: "plaintext",
    inline: "plaintext",
  },
};
```

### `transformers{:.meta.object-literal.key}`

[Transformers](https://shiki.style/guide/transformers#transformers)æ˜¯ Shiki çš„åŸç”Ÿæ–¹å¼ï¼Œç”¨äºæ“ä½œä»£ç å—çš„`hAST`æ ‘ï¼Œå¹¶è¿›ä¸€æ­¥æ‰©å±•æ­¤æ’ä»¶çš„è¡Œä¸ºã€‚ [`@shikijs/transformers`](https://npm.im/@shikijs/transformers)è¯¥åŒ…æä¾›äº†ä¸€äº›æœ‰ç”¨çš„è½¬æ¢å™¨ã€‚

```js
import { transformerNotationDiff } from "@shikijs/transformers";

const options = {
  transformers: [transformerNotationDiff()],
};
```

## å…ƒå­—ç¬¦ä¸²

é€šè¿‡é¡¶éƒ¨ç å—å›´æ ä¸Šçš„å…ƒä¸²æ¥é…ç½®ç å—ã€‚

> å¦‚æœæ‚¨çš„åº“ä¹Ÿè§£æä»£ç å—çš„å…ƒå­—ç¬¦ä¸²ï¼Œåˆ™å¯èƒ½ä¼šä¸`rehype-pretty-code`å‘ç”Ÿ[å†²çª](https://github.com/atomiks/rehype-pretty-code/issues/52)ã€‚
> è¿™ä¸ªé€‰é¡¹å…è®¸æ‚¨åœ¨åº“å¼€å§‹è§£æå…ƒå­—ç¬¦ä¸²ä¹‹å‰è¿‡æ»¤æ‰å®ƒçš„æŸäº›éƒ¨åˆ†ã€‚
>
> ```js
> const options = {
>   filterMetaString: (string) => string.replace(/filename="[^"]*"/, ""),
> };
> ```

#### é«˜äº®æ˜¾ç¤ºçº¿æ¡

å°†æ•°å­—èŒƒå›´æ”¾åœ¨`{}`å†…ã€‚

````md
```js {1-3,4}

```
````

**æ ·å¼**: è¡Œ`<span>{:html}`æ¥æ”¶ä¸€ä¸ª`data-highlighted-line`å±æ€§ï¼Œè¯¥å±æ€§ä½¿æ‚¨èƒ½å¤Ÿé€šè¿‡ CSS è¿›è¡Œæ ·å¼è®¾ç½®ã€‚

#### æŒ‰ Id åˆ†ç»„é«˜äº®æ˜¾ç¤ºçš„è¡Œ

å°† id æ”¾åœ¨`#`ä¹‹åçš„`{}`ä¹‹åã€‚ è¿™å…è®¸æ‚¨æ ¹æ®çº¿æ¡çš„ id å¯¹å…¶è¿›è¡Œä¸åŒçš„é¢œè‰²æˆ–æ ·å¼è®¾ç½®ã€‚

````md
```js {1,2}#a {3,4}#b

```
````

**æ ·å¼**: è¡Œ`<span>{:html}`æ¥æ”¶ä¸€ä¸ª`data-highlighted-line-id="<id>"`å±æ€§ï¼Œè¯¥å±æ€§ä½¿æ‚¨èƒ½å¤Ÿé€šè¿‡ CSS è¿›è¡Œæ ·å¼è®¾ç½®ã€‚

#### çªå‡ºæ˜¾ç¤ºå­—ç¬¦

æ‚¨å¯ä»¥ä½¿ç”¨`/`:

````md
```js /carrot/

```
````

æˆ–`"`ä½œä¸ºåˆ†éš”ç¬¦:

````md
```js "carrot"

```
````

è¿˜å¯ä»¥çªå‡ºæ˜¾ç¤ºä¸åŒçš„å­—ç¬¦æ®µï¼š

````md
```js /carrot/ /apple/

```
````

**æ ·å¼**: å­—ç¬¦`<span>{:html}`é€šè¿‡ CSS æ¥æ”¶`data-highlighted-chars`å±æ€§ä»¥è¿›è¡Œæ ·å¼è®¾ç½®ã€‚

ä¸ºäº†åªçªå‡ºæ˜¾ç¤º`carrot`çš„ç¬¬ä¸‰åˆ°ç¬¬äº”ä¸ªå®ä¾‹ï¼Œå¯ä»¥åœ¨æœ€åä¸€ä¸ª`/`ä¹‹åæ”¾ç½®ä¸€ä¸ªæ•°å­—èŒƒå›´ã€‚

````md
```js /carrot/3-5

```
````

ä»…çªå‡ºæ˜¾ç¤º`carrot`çš„ç¬¬ä¸‰åˆ°ç¬¬äº”ä¸ªå®ä¾‹ä»¥åŠ`apple`çš„ä»»ä½•å®ä¾‹ã€‚

````md
```js /carrot/3-5 /apple/

```
````

#### æŒ‰ Id åˆ†ç»„çªå‡ºæ˜¾ç¤ºçš„å­—ç¬¦

åœ¨å­—ç¬¦åé¢çš„`#`åé¢æ”¾ä¸€ä¸ª idã€‚è¿™å…è®¸æ‚¨æ ¹æ®å­—ç¬¦çš„ id å¯¹å…¶è¿›è¡Œä¸åŒçš„ç€è‰²ã€‚

````md
```js /age/#v /name/#v /setAge/#s /setName/#s /50/#i /"Taylor"/#i
const [age, setAge] = useState(50);
const [name, setName] = useState("Taylor");
```
````

```js /age/#v /name/#v /setAge/#s /setName/#s /50/#i /"Taylor"/#i
const [age, setAge] = useState(50);
const [name, setName] = useState("Taylor");
```

**æ ·å¼**: å­—ç¬¦ `<span>{:html}` å±æ€§é€šè¿‡ CSS æ¥æ”¶ `data-chars-id="<id>"` è½¬æ¢ä¸ºæ ·å¼ã€‚

#### çªå‡ºæ˜¾ç¤ºå†…è”ä»£ç 

è¿½åŠ  `\{:lang}` (e.g. `\{:js}`) åˆ°å†…è”ä»£ç çš„æœ«å°¾ï¼Œä»¥åƒå¸¸è§„ä»£ç å—ä¸€æ ·çªå‡ºæ˜¾ç¤ºå®ƒã€‚

```md
This is an array `[1, 2, 3]{:js}` of numbers 1 through 3.
```

#### çªå‡ºæ˜¾ç¤ºçº¯æ–‡æœ¬

å°†`\{:.token}`é™„åŠ åˆ°å†…è”ä»£ç çš„æœ«å°¾ï¼Œä»¥æ ¹æ® VS ä»£ç ä¸»é¢˜ä¸­æŒ‡å®šçš„ä»¤ç‰Œçªå‡ºæ˜¾ç¤ºå®ƒã€‚
ä»¤ç‰Œä»¥`.`å¼€å¤´å°†å®ƒä»¬ä¸ä¸€ç§è¯­è¨€åŒºåˆ†å¼€æ¥ã€‚

```md
The name of the function is `getStringLength{:.entity.name.function}`.
```

æ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªä»¤ç‰Œæ˜ å°„ï¼Œä»¥ç¼©çŸ­æ•´ä¸ªæ–‡æ¡£çš„ä½¿ç”¨æ—¶é—´ï¼š

```js
const options = {
  tokensMap: {
    fn: "entity.name.function",
  },
};
```

```md
The name of the function is `getStringLength{:.fn}`.
```

#### æ ‡é¢˜

å°†æ–‡ä»¶æ ‡é¢˜æ·»åŠ åˆ°ä»£ç å—ä¸­ï¼Œæ–‡æœ¬ä½äºåŒå¼•å·å†… (`""`):

````md
```js title="..."

```
````

#### å­—å¹•

åœ¨ä»£ç å—ä¸‹é¢æ·»åŠ ä¸€ä¸ªå­—å¹•ï¼Œæ–‡æœ¬ä½äºåŒå¼•å·å†… (`""`):

````md
```js caption="..."

```
````

## è¡Œå·

CSS è®¡æ•°å™¨å¯ç”¨äºæ·»åŠ è¡Œå·ã€‚

```css {2,6-7}
code {
  counter-reset: line;
}

code > [data-line]::before {
  counter-increment: line;
  content: counter(line);

  /* Other styling */
  display: inline-block;
  width: 1rem;
  margin-right: 2rem;
  text-align: right;
  color: gray;
}

code[data-line-numbers-max-digits="2"] > [data-line]::before {
  width: 2rem;
}

code[data-line-numbers-max-digits="3"] > [data-line]::before {
  width: 3rem;
}
```

å¦‚æœè¦æœ‰æ¡ä»¶åœ°æ˜¾ç¤ºå®ƒä»¬ï¼Œè¯·ä½¿ç”¨ `showLineNumbers`:

````md
```js showLineNumbers

```
````

**æ ·å¼**: `<code>{:html}` å°†å…·æœ‰å±æ€§ `data-line-numbers` å’Œ `data-line-numbers-max-digits="n"`.

å¦‚æœè¦ä»¥ç‰¹å®šæ•°å­—å¼€å§‹è¡Œå·ï¼Œè¯·ä½¿ç”¨`showLineNumbers{number}`:

````md
```js showLineNumbers{number}

```
````

## å¤šä¸ªä¸»é¢˜ (æ·±è‰²å’Œæµ…è‰²æ¨¡å¼)

å°†ä¸»é¢˜ä¼ é€’ç»™ `theme{:.meta.object-literal.key}`, å…¶ä¸­é”®è¡¨ç¤ºé¢œè‰²æ¨¡å¼:

```js
const options = {
  theme: {
    dark: "github-dark-dimmed",
    light: "github-light",
  },
};
```

ç°åœ¨ï¼Œä½¿ç”¨ä»¥ä¸‹ CSS æ¥æ˜¾ç¤ºå¯å˜é¢œè‰² â€” å¦‚æœåœ¨ä¸»é¢˜åç§°ä¸­æ‰¾åˆ°ç©ºæ ¼ï¼Œåˆ™åŸºäºè¯¥å¯¹è±¡çš„ CSS å˜é‡é”®å¯ç”¨ ([æ›´å¤šä¿¡æ¯](https://shiki.style/guide/dual-themes#light-dark-dual-themes)):

```scss
code[data-theme*=" "],
code[data-theme*=" "] span {
  color: var(--shiki-light);
  background-color: var(--shiki-light-bg);
}

@media (prefers-color-scheme: dark) {
  code[data-theme*=" "],
  code[data-theme*=" "] span {
    color: var(--shiki-dark);
    background-color: var(--shiki-dark-bg);
  }
}
```

`<code>{:html}` å’Œ `<pre>{:html}` å…ƒç´ å°†å…·æœ‰æ•°æ®å±æ€§`data-theme="...themes"`, å•ç‹¬åˆ—å‡ºæ¯ä¸ªä¸»é¢˜å€¼ç©ºé—´:

```html
<code data-theme="github-dark-dimmed github-light"></code>
```

## è®¿å®¢æŒ‚é’©

è¦è‡ªå®šä¹‰ HTML è¾“å‡ºï¼Œå¯ä»¥ä½¿ç”¨è®¿é—®è€…å›è°ƒæŒ‚é’©ç›´æ¥æ“ä½œ[hAST å…ƒç´ ](https://github.com/syntax-tree/hast#element):

```js
const options = {
  onVisitLine(element) {
    console.log("Visited line");
  },
  onVisitHighlightedLine(element) {
    console.log("Visited highlighted line");
  },
  onVisitHighlightedChars(element) {
    console.log("Visited highlighted chars");
  },
  onVisitTitle(element) {
    console.log("Visited title");
  },
  onVisitCaption(element) {
    console.log("Visited caption");
  },
};
```

## è‡ªå®šä¹‰é«˜äº®å™¨

è¦å®Œå…¨é…ç½®è§å…‰ç¬”, ä½¿ç”¨`getHighlighter{:.entity.name.function}`é€‰é¡¹. å¦‚æœæ‚¨æƒ³é…ç½®å…¶ä»– Shiki é€‰é¡¹ï¼Œè¿™å¾ˆæœ‰å¸®åŠ©, ä¾‹å¦‚ `langs{:.meta.object-literal.key}`.

```js
import { getHighlighter } from "shiki";

const options = {
  getHighlighter: (options) =>
    getHighlighter({
      ...options,
      langs: ["plaintext", async () => JSON.parse(await readFile("my-grammar.json", "utf-8"))],
    }),
};
```

## React æœåŠ¡å™¨ç»„ä»¶

[ç”¨æ³•](#usage)ç›´æ¥åœ¨ React æœåŠ¡å™¨ç»„ä»¶ä¸­å·¥ä½œã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š

```tsx title="code.tsx"
import * as React from "react";
import { unified } from "unified";
import remarkParse from "remark-parse";
import remarkRehype from "remark-rehype";
import rehypeStringify from "rehype-stringify";
import rehypePrettyCode from "rehype-pretty-code";

export async function Code({ code }: { code: string }) {
  const highlightedCode = await highlightCode(code);
  return (
    <section
      dangerouslySetInnerHTML={{
        __html: highlightedCode,
      }}
    />
  );
}

async function highlightCode(code: string) {
  const file = await unified()
    .use(remarkParse)
    .use(remarkRehype)
    .use(rehypePrettyCode, {
      keepBackground: false,
    })
    .use(rehypeStringify)
    .process(code);

  return String(file);
}
```

ç„¶åï¼Œå°† RSC å¯¼å…¥é¡µé¢æˆ–å…¶ä»–ç»„ä»¶ï¼š

```tsx src/app/rsc/page.tsx
import * as React from "react";
import { Code } from "./code.tsx";

export default async function Page() {
  return (
    <main>
      <Code code="`const numbers = [1, 2, 3]{:js}`" />
    </main>
  );
}
```

è¯·å‚é˜…[/rsc](/rsc)ä¸­çš„æ­¤ç¤ºä¾‹.
