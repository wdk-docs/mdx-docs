---
title: "rehype-highlight"
---

**[rehype][]** æ’ä»¶ï¼Œç”¨äºå°†è¯­æ³•é«˜äº®æ˜¾ç¤ºåº”ç”¨äºå¸¦æœ‰[`lowlight`][lowlight]çš„ä»£ç ã€‚

## è¿™æ˜¯ä»€ä¹ˆï¼Ÿ

è¿™ä¸ªåŒ…æ˜¯ä¸€ä¸ª[unified][] ([rehype][])æ’ä»¶ï¼Œç”¨äºæ‰§è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºã€‚
å®ƒä½¿ç”¨`highlight.js`åˆ°`lowlight`ï¼Œè¿™éå¸¸å¿«ï¼Œç›¸å¯¹è¾ƒå°ï¼Œè€Œä¸”éå¸¸å¥½ã€‚
é»˜è®¤æƒ…å†µä¸‹ï¼Œæ­¤è½¯ä»¶åŒ…æ†ç»‘äº† 37 ç§[é€šç”¨è¯­è¨€][lowlight-common]ä½ å¯ä»¥æ³¨å†Œæ›´å¤š(190 with [`all`][lowlight-all]).

å®ƒæŸ¥æ‰¾`<code>`å…ƒç´ ï¼ˆå½“ç›´æ¥åœ¨`<pre>`å…ƒç´ ä¸­æ—¶ï¼‰å¹¶æ›´æ”¹å®ƒä»¬ã€‚
æ‚¨å¯ä»¥ç”¨`language-*`æˆ–`lang-*`ç±»æŒ‡å®šä»£ç è¯­è¨€ï¼ˆå¦‚ Pythonï¼‰ï¼Œå…¶ä¸­`*`å¯ä»¥æ˜¯ä¾‹å¦‚`js`ï¼ˆæ‰€ä»¥`language-js`ï¼‰ã€`md`ã€`css`ç­‰ã€‚
é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸çªå‡ºæ˜¾ç¤ºæ²¡æœ‰æ­¤ç±»è¯­è¨€ç±»çš„ä»£ç ã€‚
é€šè¿‡`detect: true`æ¥æ£€æµ‹ä»–ä»¬çš„ç¼–ç¨‹è¯­è¨€å¹¶çªå‡ºæ˜¾ç¤ºä»£ç ã€‚
æ‚¨å¯ä»¥é˜²æ­¢åœ¨`<code>`ä¸Šä½¿ç”¨`no-highlight` æˆ– `nohighlight`ç±»é«˜äº®æ˜¾ç¤ºç‰¹å®šå—ã€‚

**unified**æ˜¯ä¸€ä¸ªä½¿ç”¨æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰è½¬æ¢å†…å®¹çš„é¡¹ç›®ã€‚
**rehype**ä¸º unified æ·»åŠ äº†å¯¹ HTML çš„æ”¯æŒã€‚
**hast**æ˜¯é‡æ–°é”®å…¥ä½¿ç”¨çš„ HTML ASTã€‚
è¿™æ˜¯ä¸€ä¸ªå°†è¯­æ³•é«˜äº®æ˜¾ç¤ºåº”ç”¨äº AST çš„é‡æ–°ç±»å‹æ’ä»¶ã€‚

## æˆ‘ä»€ä¹ˆæ—¶å€™è¯¥ç”¨è¿™ä¸ªï¼Ÿ

å½“æ‚¨å¸Œæœ›åœ¨é‡æ–°é”®å…¥ä¸­æ‰§è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºæ—¶ï¼Œæ­¤é¡¹ç›®éå¸¸æœ‰ç”¨ã€‚
è¿™æ ·åšçš„ä¸€ä¸ªåŸå› æ˜¯ï¼Œè¿™é€šå¸¸æ„å‘³ç€é«˜äº®æ˜¾ç¤ºåœ¨æ„å»ºæ—¶å‘ç”Ÿä¸€æ¬¡ï¼Œè€Œä¸æ˜¯æ¯æ¬¡åœ¨è¿è¡Œæ—¶å‘ç”Ÿã€‚

è¿˜æœ‰å…¶ä»–å‡ ä¸ªåº”ç”¨è¯­æ³•é«˜äº®æ˜¾ç¤ºçš„ç¤¾åŒºæ’ä»¶ã€‚
å…¶ä¸­ä¸€äº›æ˜¯å¾ˆå¥½çš„é€‰æ‹©ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›æ˜¯å¤±è´¥çš„ã€‚
ç”±äºä»»ä½•äººéƒ½å¯ä»¥åˆ¶ä½œé‡æ–°é”®å…¥çš„æ’ä»¶ï¼Œè¯·ç¡®ä¿ä»”ç»†è¯„ä¼°é‡æ–°é”®å…¥æ’ä»¶çš„è´¨é‡ã€‚

è¿™ä¸ªæ’ä»¶æ˜¯åŸºäº[`lowlight`][lowlight]æ„å»ºçš„ï¼Œå®ƒæ˜¯ highlight.js çš„è™šæ‹Ÿç‰ˆæœ¬ã€‚
å½“ä½ æƒ³ä»¥ä¸åŒçš„æ–¹å¼åšäº‹æ—¶ï¼Œä½ å¯ä»¥åœ¨è¿™ä¸ªæ’ä»¶çš„åŸºç¡€ä¸Šåˆ¶ä½œä¸€ä¸ª lowlight æ’ä»¶ã€‚

## å®‰è£…

æ­¤ç¨‹åºåŒ…æ˜¯[ESM only][ESM]ã€‚
åœ¨ Node.jsï¼ˆ16+ç‰ˆæœ¬ï¼‰ä¸­ï¼Œä½¿ç”¨[npm][]å®‰è£…ï¼š

```sh
npm install rehype-highlight
```

åœ¨å¸¦æœ‰[`esm.sh`][esmsh]çš„ Deno ä¸­ï¼š

```js
import rehypeHighlight from "https://esm.sh/rehype-highlight@6";
```

åœ¨å¸¦æœ‰[`esm.sh`][esmsh]çš„æµè§ˆå™¨ä¸­ï¼š

```html
<script type="module">
  import rehypeHighlight from "https://esm.sh/rehype-highlight@6?bundle";
</script>
```

## ä½¿ç”¨

å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹æ–‡ä»¶`example.html`ï¼š

```html
<h1>Hello World!</h1>

<pre>
    <code class="language-js">
        var name = "World";
        console.warn("Hello, " + name + "!")
    </code>
</pre>
```

â€¦æˆ‘ä»¬çš„æ¨¡å—`example.js`åŒ…å«:

```js
import { rehype } from "rehype";
import rehypeHighlight from "rehype-highlight";
import { read } from "to-vfile";

const file = await rehype()
  .data("settings", { fragment: true })
  .use(rehypeHighlight)
  .process(await read("example.html"));

console.log(String(file));
```

â€¦é‚£ä¹ˆè¿è¡Œ node-example.js ä¼šäº§ç”Ÿ:

```html
<h1>Hello World!</h1>

<pre><code class="hljs language-js"><span class="hljs-keyword">var</span> name = <span class="hljs-string">"World"</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">"Hello, "</span> + name + <span class="hljs-string">"!"</span>)</code></pre>
```

## API

æ­¤åŒ…ä¸å¯¼å‡ºæ ‡è¯†ç¬¦ã€‚
é»˜è®¤å¯¼å‡ºä¸º [`rehypeHighlight`][api-rehype-highlight].

### `unified().use(rehypeHighlight[, options])`

åº”ç”¨è¯­æ³•é«˜äº®æ˜¾ç¤ºã€‚

###### å‚æ•°

- `options` ([`Options`][api-options], optional)
  â€” configuration

###### è¿”å›

Transform ([`Transformer`][unified-transformer]).

### `Options`

é…ç½® (TypeScript type).

###### å­—æ®µ

- `aliases` (`Record<string, Array<string> | string>`, optional)
  â€” æ³¨å†Œæ›´å¤šåˆ«å;
  ä¼ é€’ç»™ [`lowlight.registerAlias`][lowlight-register-alias]
- `detect` (`boolean`, default: `false`)
  â€” é€šè¿‡çŒœæµ‹å…¶ç¼–ç¨‹è¯­è¨€æ¥çªå‡ºæ˜¾ç¤ºæ²¡æœ‰è¯­è¨€ç±»çš„ä»£ç 
- `languages` (`Record<string, LanguageFn>`, é»˜è®¤:[`common`][lowlight-common])
  â€” è¯­åŸŸè¯­è¨€ï¼›ä¼ é€’åˆ°[`lowlight.register`][lowlight-register]
- `plainText` (`Array<string>`, optional)
  â€” ä¸çªå‡ºæ˜¾ç¤ºçš„è¯­è¨€åç§°åˆ—è¡¨ï¼›æ³¨æ„ï¼Œæ‚¨è¿˜å¯ä»¥æ·»åŠ `no-highlight`ç±»
- `prefix` (`string`, é»˜è®¤: `'hljs-'`)
  â€” ç±»å‰ç¼€
- `subset` (`Array<string>`, é»˜è®¤: é»˜è®¤: [all][lowlight-all] æ³¨å†Œè¯­è¨€)
  â€” æ£€æµ‹æ—¶è¦æ£€æŸ¥çš„è¯­è¨€åç§°

## å®ä¾‹

### å®ä¾‹: å¿½ç•¥

æœ‰ä¸‰ç§æ–¹æ³•å¯ä»¥ä¸å°†è¯­æ³•é«˜äº®æ˜¾ç¤ºåº”ç”¨äºä»£ç å—ã€‚
å®ƒä»¬å¯ä»¥é€šè¿‡æ˜¾å¼ç±»`no-highlight`å¿½ç•¥ (æˆ– `nohighlight`),
åœ¨`options.plainText`ä¸­åˆ—å‡ºçš„æ˜¾å¼è¯­è¨€åç§°,
æˆ–é€šè¿‡å°†`options.detect`è®¾ç½®ä¸º`false`ï¼ˆé»˜è®¤å€¼ï¼‰,
è¿™é˜²æ­¢äº†æ²¡æœ‰ç±»çš„`<code>`è¢«è‡ªåŠ¨æ£€æµ‹åˆ°ã€‚

ä¾‹å¦‚ï¼Œä½¿ç”¨`example.html`ï¼š

```html
<pre><code>this wonâ€™t be highlighted due to `detect: false` (default)</code></pre>

<pre><code class="no-highlight">this wonâ€™t be highlighted due to its class</code></pre>

<pre><code class="language-txt">this wonâ€™t be highlighted due to `plainText: ['txt']`</code></pre>
```

â€¦å’Œ `example.js`:

```js
import { rehype } from "rehype";
import rehypeHighlight from "rehype-highlight";
import { read } from "to-vfile";

const file = await rehype()
  .data("settings", { fragment: true })
  .use(rehypeHighlight, { plainText: ["txt", "text"] })
  .process(await read("example.html"));

console.log(String(file));
```

â€¦ç„¶åè¿è¡Œå®ƒä¼šäº§ç”Ÿä¸`example.html`ç›¸åŒçš„ç»“æœ: æ²¡æœ‰ä¸€ä¸ªçªå‡ºæ˜¾ç¤ºã€‚

### å®ä¾‹: æ·»åŠ æ–°è¯­è¨€

`rehype-highlight`é»˜è®¤æ”¯æŒ 37 ç§å¸¸ç”¨è¯­è¨€ã€‚
è¿™ä½¿å¾—å®ƒåœ¨æµè§ˆå™¨å’Œ Node.js ä¸­åŠ è½½å¾ˆå°ï¼ŒåŒæ—¶æ”¯æŒè¶³å¤Ÿå¤šçš„é»˜è®¤æƒ…å†µã€‚
æ‚¨å¯ä»¥æ·»åŠ æ›´å¤šè¯­è¨€ã€‚

ä¾‹å¦‚ï¼Œä½¿ç”¨`example.html`ï¼š

```html
<pre><code class="language-bnf">a ::= 'a' | 'A'</code></pre>
```

â€¦å’Œ `example.js`:

```js
import bnf from "highlight.js/lib/languages/bnf";
import { common } from "lowlight";
import { rehype } from "rehype";
import rehypeHighlight from "rehype-highlight";
import { read } from "to-vfile";

const file = await rehype()
  .data("settings", { fragment: true })
  .use(rehypeHighlight, { languages: { ...common, bnf } })
  .process(await read("example.html"));

console.log(String(file));
```

â€¦ç„¶åè¿è¡Œä¼šäº§ç”Ÿ:

```html
<pre><code class="hljs language-bnf">a ::= <span class="hljs-string">'a'</span> | <span class="hljs-string">'A'</span></code></pre>
```

### å®ä¾‹: åˆ«å

æ‚¨å¯ä»¥å°†è‡ªå·±çš„è¯­è¨€æ ‡å¿—æ˜ å°„åˆ°`highlight.js`è¯­è¨€ã€‚

ä¾‹å¦‚ï¼Œä½¿ç”¨`example.html`ï¼š

```html
<pre><code class="language-custom-script">console.log(1)</code></pre>
```

â€¦å’Œ `example.js`:

```js
import { rehype } from "rehype";
import rehypeHighlight from "rehype-highlight";
import { read } from "to-vfile";

const file = await rehype()
  .data("settings", { fragment: true })
  // ğŸ‘‰ **Note**: the keys are language names, values are the aliases that you
  // want to also allow as `x` in `language-x` classes.
  .use(rehypeHighlight, { aliases: { javascript: "custom-script" } })
  .process(await read("example.html"));

console.log(String(file));
```

â€¦ç„¶åè¿è¡Œä¼šäº§ç”Ÿ:

```html
<pre><code class="hljs language-custom-script"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">1</span>)</code></pre>
```

### å®ä¾‹: sanitation

åœ¨ rehype ä¸­åº”ç”¨è¯­æ³•é«˜äº®æ˜¾ç¤ºæ“ä½œå…·æœ‰æŸäº›ç±»çš„`<code>`å…ƒç´ ï¼Œå¹¶å°†è®¸å¤š`<span>`å…ƒç´ æ³¨å…¥å…·æœ‰ç±»çš„å…ƒç´ ã€‚
å…è®¸ä»»æ„ç±»æ˜¯å®‰å…¨æ¼æ´çš„ä¸€ä¸ªæ¼æ´ã€‚

è¦ç¡®ä¿ HTML åœ¨é‡æ–°é”®å…¥æ—¶çš„å®‰å…¨æ€§ï¼Œè¯·ä½¿ç”¨[`rehype-sanitize`][rehype-sanitize]ã€‚
å®ƒç‰¹åˆ«å…è®¸åœ¨`<code>`å…ƒç´ ä¸Š`/^language-./` ç±»å .
æˆ‘ä»¬ä¹Ÿä½¿ç”¨å®ƒã€‚
å› æ­¤ï¼Œæ‚¨å¯ä»¥åœ¨`rehype-sanitize`ä¹‹åä½¿ç”¨`rehype-highlight`ï¼š

```js
import { unified } from "unified";
import rehypeHighlight from "./index.js";
import rehypeParse from "rehype-parse";
import rehypeSanitize, { defaultSchema } from "rehype-sanitize";
import rehypeStringify from "rehype-stringify";

const file = await unified()
  .use(rehypeParse, { fragment: true })
  .use(rehypeSanitize)
  .use(rehypeHighlight)
  .use(rehypeStringify)
  .process('<pre><code className="language-js">console.log(1)</code></pre>');

console.log(String(file));
```

â€¦è¾“å‡º:

```html
<pre><code class="hljs language-js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">1</span>)</code></pre>
```

åƒæˆ‘ä»¬åˆšæ‰æ‰€åšçš„é‚£æ ·ï¼Œåœ¨`rehype-sanitize`ä¹‹åä½¿ç”¨æ’ä»¶æ˜¯å®‰å…¨çš„ï¼Œå‰ææ˜¯æ‚¨ä¿¡ä»»è¿™äº›æ’ä»¶ã€‚
å¦‚æœæ‚¨ä¸ä¿¡ä»»`rehype-highlight`ï¼Œåˆ™å¯ä»¥åœ¨ä¹‹å‰ä½¿ç”¨å®ƒã€‚
ä½†æ˜¯ï¼Œæ‚¨éœ€è¦é…ç½®`rehype-sanitize`ä»¥ä¿ç•™æ‚¨å…è®¸çš„ç±»ï¼š

```js
import { unified } from "unified";
import rehypeHighlight from "./index.js";
import rehypeParse from "rehype-parse";
import rehypeSanitize, { defaultSchema } from "rehype-sanitize";
import rehypeStringify from "rehype-stringify";

const file = await unified()
  .use(rehypeParse, { fragment: true })
  .use(rehypeHighlight)
  .use(rehypeSanitize, {
    ...defaultSchema,
    attributes: {
      ...defaultSchema.attributes,
      span: [
        ...(defaultSchema.attributes?.span || []),
        // Allow all class names starting with `hljs-`.
        ["className", /^hljs-./],
        // Alternatively, to allow only certain class names:
        // ['className', 'hljs-number', 'hljs-title', 'hljs-variable']
      ],
    },
    tagNames: [...(defaultSchema.tagNames || []), "span"],
  })
  .use(rehypeStringify)
  .process('<pre><code className="language-js">console.log(1)</code></pre>');

console.log(String(file));
```

## ç±»å‹

æ­¤åŒ…æ˜¯ä½¿ç”¨[TypeScript][]å®Œå…¨é”®å…¥çš„ã€‚
å®ƒå¯¼å‡ºé™„åŠ ç±»å‹[`Options`][api-options]ã€‚

## å…¼å®¹æ€§

ç»Ÿä¸€é›†ä½“ç»´æŠ¤çš„é¡¹ç›®ä¸ Node.js çš„ç»´æŠ¤ç‰ˆæœ¬å…¼å®¹ã€‚

å½“æˆ‘ä»¬å‰ªåˆ‡ä¸€ä¸ªæ–°çš„ä¸»è¦ç‰ˆæœ¬æ—¶ï¼Œæˆ‘ä»¬ä¼šæ”¾å¼ƒå¯¹ Node çš„æœªç»´æŠ¤ç‰ˆæœ¬çš„æ”¯æŒã€‚
è¿™æ„å‘³ç€æˆ‘ä»¬è¯•å›¾ä¿æŒå½“å‰å‘å¸ƒè¡Œ`rehype-highlight@^7`ä¸ Node.js 16 å…¼å®¹ã€‚

æ­¤æ’ä»¶é€‚ç”¨äº`rehype-parse` version 1+, `rehype-stringify` version 1+, `rehype` version 1+, and `unified` version 4+.

## å®‰å…¨

Use of `rehype-highlight` _should_ be safe to use as `highlight.js` and `lowlight` _should_ be safe to use.
å¦‚æœ‰ç–‘é—®ï¼Œè¯·ä½¿ç”¨[`rehype-sanitize`][rehype-sanitize].

## ç›¸å…³çš„

- [`rehype-meta`](https://github.com/rehypejs/rehype-meta)
  â€” å°†å…ƒæ•°æ®æ·»åŠ åˆ°æ–‡æ¡£çš„æ ‡é¢˜
- [`rehype-document`](https://github.com/rehypejs/rehype-document)
  â€” å°†ç‰‡æ®µåŒ…è£…åœ¨æ–‡æ¡£ä¸­

## è´¡çŒ®

æœ‰å…³å…¥é—¨æ–¹æ³•ï¼Œè¯·å‚é˜…[`rehypejs/.github`][health]ä¸­çš„[`contributing.md`][contributing]ã€‚
æœ‰å…³è·å¾—å¸®åŠ©çš„æ–¹æ³•ï¼Œè¯·å‚é˜…[`support.md`][support]ã€‚

è¿™ä¸ªé¡¹ç›®æœ‰[è¡Œä¸ºå‡†åˆ™][coc].
é€šè¿‡ä¸æ­¤å­˜å‚¨åº“ã€ç»„ç»‡æˆ–ç¤¾åŒºäº¤äº’ï¼Œæ‚¨åŒæ„éµå®ˆå…¶æ¡æ¬¾ã€‚

## è®¸å¯è¯

[MIT][license] Â© [Titus Wormer][author]

[build-badge]: https://github.com/rehypejs/rehype-highlight/workflows/main/badge.svg
[build]: https://github.com/rehypejs/rehype-highlight/actions
[coverage-badge]: https://img.shields.io/codecov/c/github/rehypejs/rehype-highlight.svg
[coverage]: https://codecov.io/github/rehypejs/rehype-highlight
[downloads-badge]: https://img.shields.io/npm/dm/rehype-highlight.svg
[downloads]: https://www.npmjs.com/package/rehype-highlight
[size-badge]: https://img.shields.io/bundlejs/size/rehype-highlight
[size]: https://bundlejs.com/?q=rehype-highlight
[sponsors-badge]: https://opencollective.com/unified/sponsors/badge.svg
[backers-badge]: https://opencollective.com/unified/backers/badge.svg
[collective]: https://opencollective.com/unified
[chat-badge]: https://img.shields.io/badge/chat-discussions-success.svg
[chat]: https://github.com/rehypejs/rehype/discussions
[npm]: https://docs.npmjs.com/cli/install
[esm]: https://gist.github.com/sindresorhus/a39789f98801d908bbc7ff3ecc99d99c
[esmsh]: https://esm.sh
[health]: https://github.com/rehypejs/.github
[contributing]: https://github.com/rehypejs/.github/blob/HEAD/contributing.md
[support]: https://github.com/rehypejs/.github/blob/HEAD/support.md
[coc]: https://github.com/rehypejs/.github/blob/HEAD/code-of-conduct.md
[license]: license
[author]: https://wooorm.com
[lowlight]: https://github.com/wooorm/lowlight
[lowlight-all]: https://github.com/wooorm/lowlight#all
[lowlight-common]: https://github.com/wooorm/lowlight#common
[lowlight-register]: https://github.com/wooorm/lowlight#lowlightregistergrammars
[lowlight-register-alias]: https://github.com/wooorm/lowlight#lowlightregisteraliasaliases
[rehype]: https://github.com/rehypejs/rehype
[rehype-sanitize]: https://github.com/rehypejs/rehype-sanitize
[typescript]: https://www.typescriptlang.org
[unified]: https://github.com/unifiedjs/unified
[unified-transformer]: https://github.com/unifiedjs/unified#transformer
[api-options]: #options
[api-rehype-highlight]: #unifieduserehypehighlight-options
