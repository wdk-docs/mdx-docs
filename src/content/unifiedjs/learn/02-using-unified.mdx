---
group: guide
index: 2
title: ä½¿ç”¨ unified
description: æ·±å…¥æ¢è®¨å°†Markdownè½¬æ¢ä¸ºHTMLçš„æŒ‡å—
author: Titus Wormer
authorTwitter: wooorm
authorGithub: wooorm
tags:
  - use
  - transform
  - remark
  - rehype
published: 2017-05-03
modified: 2020-06-14
---

## ä½¿ç”¨ unified

æœ¬æŒ‡å—æ·±å…¥æ¢è®¨äº†å¦‚ä½•ä½¿ç”¨ unified æ¥å°† Markdown æ–‡ä»¶è½¬æ¢ä¸º HTMLã€‚
å®ƒè¿˜å°†å±•ç¤ºå¦‚ä½•ç”Ÿæˆä¸€ä¸ªç›®å½•ï¼Œå¹¶é¿å…æ£€æŸ¥æ•£æ–‡ã€‚

> å¡ä½äº†ï¼Ÿ
> æœ‰å…¶ä»–å¯¼æ¸¸çš„æƒ³æ³•å—ï¼Ÿ
> è¯·å‚é˜…[`support.md`][support]ã€‚

### æ ‘è½¬æ¢

å¯¹äºæœ¬ä¾‹ï¼Œæˆ‘ä»¬å°†ä» Markdown å†…å®¹å¼€å§‹ï¼Œç„¶åè½¬æ¢ä¸º HTMLã€‚
æˆ‘ä»¬éœ€è¦ä¸€ä¸ª Markdown è§£æå™¨å’Œä¸€ä¸ª HTML å­—ç¬¦ä¸²ç”Ÿæˆå™¨ã€‚
ç›¸å…³é¡¹ç›®åˆ†åˆ«ä¸º[`remark-parse`][parse]å’Œ[`rehype-stringify`][stringify]ã€‚
è¦åœ¨è¿™ä¸¤ç§è¯­æ³•ä¹‹é—´è½¬æ¢ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨[`remark-rehype`][remark-rehype].
æœ€åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ unified æœ¬èº«å°†å®ƒä»¬ç²˜åˆåœ¨ä¸€èµ·ï¼Œå¹¶ä½¿ç”¨[`unified-stream`][unified-stream]è¿›è¡Œæµå¼ä¼ è¾“ã€‚

é¦–å…ˆå»ºç«‹ä¸€ä¸ªé¡¹ç›®ã€‚
åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹`example`ï¼Œè¾“å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œç„¶ååˆå§‹åŒ–ä¸€ä¸ªæ–°é¡¹ç›®ï¼š

```sh
mkdir example
cd example
npm init -y
```

ç„¶åï¼Œé€šè¿‡æ›´æ”¹`package.json`ï¼Œç¡®ä¿é¡¹ç›®æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œä»¥ä¾¿`import`å’Œ`export`å·¥ä½œï¼š

```diff
--- a/package.json
+++ b/package.json
@@ -2,6 +2,7 @@
   "name": "example",
   "version": "1.0.0",
   "description": "",
+  "type": "module",
   "main": "index.js",
   "scripts": {
     "test": "echo \"Error: no test specified\" && exit 1"
```

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨[npm][]å®‰è£…æ‰€éœ€çš„ä¾èµ–é¡¹ï¼Œè¯¥ä¾èµ–é¡¹ä¸[Node][]æ†ç»‘åœ¨ä¸€èµ·ã€‚

```sh
npm install unified unified-stream remark-parse remark-rehype rehype-stringify
```

ç°åœ¨åˆ›å»ºä¸€ä¸ª Markdown æ–‡ä»¶ï¼Œ`example.md`ï¼Œæˆ‘ä»¬å°†å¯¹å…¶è¿›è¡Œè½¬æ¢ã€‚

```markdown
# Hello World

## Table of Content

## Install

A **example**.

## Use

More `text`.

## License

MIT
```

ç„¶ååˆ›å»º`index.js`ã€‚
å®ƒå°† Markdown è½¬æ¢ä¸º HTMLã€‚
å®ƒè¢«è¿æ¥ä¸ºä» stdin è¯»å–å’Œå‘ stdout å†™å…¥ã€‚

```javascript
import { stream } from "unified-stream";
import { unified } from "unified";
import remarkParse from "remark-parse";
import remarkRehype from "remark-rehype";
import rehypeStringify from "rehype-stringify";

const processor = unified().use(remarkParse).use(remarkRehype).use(rehypeStringify);

process.stdin.pipe(stream(processor)).pipe(process.stdout);
```

ç°åœ¨ï¼Œä½¿ç”¨[Node][]è¿è¡Œæˆ‘ä»¬çš„è„šæœ¬ï¼ˆè¿™å°†ä½¿ç”¨ Shell è¯»å–`example.md`å¹¶å†™å…¥`example.html`ï¼‰ï¼š

```sh
node index.js < example.md > example.html
```

â€¦ç»™äº†æˆ‘ä»¬ä¸€ä¸ª`example.html`æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```html
<h1>Hello World</h1>
<h2>Table of Content</h2>
<h2>Install</h2>
<p>A <strong>example</strong>.</p>
<h2>Use</h2>
<p>More <code>text</code>.</p>
<h2>License</h2>
<p>MIT</p>
```

> è¯·æ³¨æ„ï¼Œ[`remark-rehype`][remark-rehype]ä¸å¤„ç† Markdown ä¸­çš„ HTMLã€‚
> å¦‚æœä½ æ‰“ç®—è¿™ä¹ˆåšçš„è¯ï¼Œä½ éœ€è¦[`rehype-raw`][rehype-raw]ã€‚

ğŸ‰
Nifty!
å®ƒè¿˜æ²¡æœ‰èµ·åˆ°å¤šå¤§ä½œç”¨ï¼Œä½†æˆ‘ä»¬ä¼šåˆ°è¾¾é‚£é‡Œçš„ã€‚
åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡å¼•å…¥æ’ä»¶ä½¿å…¶æ›´åŠ æœ‰ç”¨ã€‚

### æ’ä»¶

æˆ‘ä»¬ä»ç„¶ç¼ºå°‘ä¸€äº›ä¸œè¥¿ï¼Œç‰¹åˆ«æ˜¯ç›®å½•å’Œé€‚å½“çš„ HTML æ–‡æ¡£ç»“æ„ã€‚

å¯¹äºå‰è€…æˆ‘ä»¬å¯ä»¥ä½¿ç”¨[`remark-slug`][slug] å’Œ [`remark-toc`][toc] , å’Œ[`rehype-document`][document] å®Œæˆåä¸€é¡¹ä»»åŠ¡.

```sh
npm install remark-slug remark-toc rehype-document
```

ç°åœ¨è®©æˆ‘ä»¬é€šè¿‡ä¿®æ”¹`index.js`æ–‡ä»¶æ¥ä½¿ç”¨è¿™ä¸¤ä¸ªï¼š

```diff
--- a/index.js
+++ b/index.js
@@ -1,12 +1,18 @@
 import {stream} from 'unified-stream'
 import {unified} from 'unified'
 import remarkParse from 'remark-parse'
+import remarkSlug from 'remark-slug'
+import remarkToc from 'remark-toc'
 import remarkRehype from 'remark-rehype'
+import rehypeDocument from 'rehype-document'
 import rehypeStringify from 'rehype-stringify'

 const processor = unified()
   .use(remarkParse)
+  .use(remarkSlug)
+  .use(remarkToc)
   .use(remarkRehype)
+  .use(rehypeDocument, {title: 'Contents'})
   .use(rehypeStringify)

 process.stdin.pipe(stream(processor)).pipe(process.stdout)
```

æˆ‘ä»¬å°†é€‰é¡¹ä¼ é€’ç»™`rehype-document`ã€‚
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨å®ƒæ¥ç¡®ä¿æŒ‰ç…§ HTML è§„èŒƒçš„è¦æ±‚ï¼Œåœ¨`<head>`ä¸­è·å¾—æ­£ç¡®çš„`<title>`å…ƒç´ ã€‚
`rehype-document`æ¥å—æ›´å¤šé€‰é¡¹ï¼Œä¾‹å¦‚ä½¿ç”¨å“ªç§è¯­è¨€æ ‡è®°ã€‚
è¿™äº›åœ¨å…¶[`readme.md`][document]ä¸­æœ‰è¯¦ç»†æè¿°ã€‚
è®¸å¤šå…¶ä»–æ’ä»¶ä¹Ÿæ¥å—é€‰é¡¹ï¼Œæ‰€ä»¥ä¸€å®šè¦é˜…è¯»å®ƒä»¬çš„æ–‡æ¡£ä»¥äº†è§£æ›´å¤šä¿¡æ¯ã€‚

> æ³¨æ„ï¼Œ remark æ’ä»¶åœ¨ Markdown æ ‘ä¸Šå·¥ä½œï¼Œé‡æ–°é”®å…¥æ’ä»¶åœ¨ HTML æ ‘ä¸Šå·¥ä½œã€‚
> æŠŠä½ çš„`.use`è°ƒç”¨æ”¾åœ¨æ­£ç¡®çš„ä½ç½®æ˜¯å¾ˆé‡è¦çš„ã€‚

ç°åœ¨ï¼Œå½“åƒä»¥å‰ä¸€æ ·è¿è¡Œè„šæœ¬æ—¶ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä»¥ä¸‹`example.html`æ–‡ä»¶ï¼š

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Contents</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>
  <body>
    <h1 id="hello-world">Hello World</h1>
    <h2 id="table-of-content">Table of Content</h2>
    <ul>
      <li><a href="#install">Install</a></li>
      <li><a href="#use">Use</a></li>
      <li><a href="#license">License</a></li>
    </ul>
    <h2 id="install">Install</h2>
    <p>A <strong>example</strong>.</p>
    <h2 id="use">Use</h2>
    <p>More <code>text</code>.</p>
    <h2 id="license">License</h2>
    <p>MIT</p>
  </body>
</html>
```

> æ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°è¯¥æ–‡æ¡£çš„æ ¼å¼ä¸å¤ªå¥½ã€‚
> ä¸è¿‡æœ‰ä¸€ä¸ªæ’ä»¶ï¼
> è¯·éšæ„å°†[`rehype-format`][rehype-format]æ·»åŠ åˆ°æ’ä»¶ä¸­ï¼Œä½äº`doc`ä¸‹æ–¹ï¼

ğŸ’¯
ä½ æˆåŠŸäº†ï¼
è¿™è¶Šæ¥è¶Šæœ‰ç”¨äº†ï¼Œå¯¹å§ï¼Ÿ

åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä¸ºåˆ›å»ºæŠ¥å‘Šå¥ å®šåŸºç¡€ã€‚

### æŠ¥å‘Š

åœ¨æˆ‘ä»¬æ£€æŸ¥ä¸€äº›æ•£æ–‡ä¹‹å‰ï¼ˆæ˜¯çš„ï¼Œæˆ‘ä»¬å·²ç»åšåˆ°äº†ï¼‰ï¼Œæˆ‘ä»¬å°†é¦–å…ˆåˆ‡æ¢`index.js`æ–‡ä»¶ä»¥æ‰“å°ä¸€ä»½æ¼‚äº®çš„æŠ¥å‘Šï¼ˆæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­å¡«å†™å®ƒï¼‰ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨[`to-vfile`][to-vfile]ä»æ–‡ä»¶ç³»ç»Ÿè¯»å–å’Œå†™å…¥è™šæ‹Ÿæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨[`vfile-reporter`][reporter]æŠ¥å‘Šä¸è¿™äº›æ–‡ä»¶ç›¸å…³çš„æ¶ˆæ¯ã€‚
è®©æˆ‘ä»¬å®‰è£…è¿™äº›ã€‚

```sh
npm install to-vfile vfile-reporter
```

â€¦ç°åœ¨ä»æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­å–æ¶ˆ stdin/stdoutï¼Œæ”¹ä¸ºä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿï¼Œå¦‚ä¸‹æ‰€ç¤º:

```diff
--- a/index.js
+++ b/index.js
@@ -1,4 +1,5 @@
-import {stream} from 'unified-stream'
+import {readSync, writeSync} from 'to-vfile'
+import {reporter} from 'vfile-reporter'
 import {unified} from 'unified'
 import remarkParse from 'remark-parse'
 import remarkSlug from 'remark-slug'
@@ -15,4 +16,15 @@ const processor = unified()
   .use(rehypeDocument, {title: 'Contents'})
   .use(rehypeStringify)

-process.stdin.pipe(stream(processor)).pipe(process.stdout)
+processor
+  .process(readSync('example.md'))
+  .then(
+    (file) => {
+      console.error(reporter(file))
+      file.extname = '.html'
+      writeSync(file)
+    },
+    (error) => {
+      throw error
+    }
+  )
```

å¦‚æœæˆ‘ä»¬ç°åœ¨åœ¨æ²¡æœ‰ shell é‡å®šå‘çš„æƒ…å†µä¸‹ç‹¬è‡ªè¿è¡Œè„šæœ¬ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªæ˜¾ç¤ºä¸€åˆ‡æ­£å¸¸çš„æŠ¥å‘Š:

```sh
$ node index.js
example.md: no issues found
```

ä½†ä¸€åˆ‡éƒ½ä¸å¥½ï¼ŒMarkdown ä¸­æœ‰ä¸€ä¸ªæ‹¼å†™é”™è¯¯ï¼
ä¸‹ä¸€èŠ‚å°†å±•ç¤ºå¦‚ä½•é€šè¿‡æ·»åŠ  retext æ¥æ£€æµ‹æ•£æ–‡é”™è¯¯ã€‚

### æ£€æŸ¥æ•£æ–‡

æˆ‘ç¡®å®æ³¨æ„åˆ°å…¶ä¸­æœ‰ä¸€ä¸ªæ‹¼å†™é”™è¯¯ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹ä¸€äº›æ•£æ–‡ï¼Œä»¥é˜²æ­¢å°†æ¥å‘ç”Ÿè¿™ç§æƒ…å†µã€‚
æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ retext åŠå…¶ç”Ÿæ€ç³»ç»Ÿè¿›è¡Œè‡ªç„¶è¯­è¨€è§£æã€‚
å½“æˆ‘ä»¬ç”¨è‹±è¯­å†™ä½œæ—¶ï¼Œæˆ‘ä»¬ä¸“é—¨ä½¿ç”¨[`retext-english`][english]æ¥è§£æè‹±è¯­è‡ªç„¶è¯­è¨€ã€‚
æˆ‘ä»¬çš„`example.md`æ–‡ä»¶ä¸­çš„é—®é¢˜æ˜¯ï¼Œå®ƒæœ‰`a example`è€Œä¸æ˜¯`an example`ï¼Œè¿™å¯ä»¥æ–¹ä¾¿åœ°é€šè¿‡[`retext-indefinite-article`][indefinite-article]è¿›è¡Œæ£€æŸ¥ã€‚
ä¸ºäº†ä»æ ‡è®°è¿‡æ¸¡åˆ°æ•£æ–‡ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨[`remark-retext`][remark-retext].
é¦–å…ˆï¼Œè®©æˆ‘ä»¬ä¹Ÿå®‰è£…è¿™äº›ä¾èµ–é¡¹ã€‚

```sh
npm install remark-retext retext-english retext-indefinite-article
```

â€¦å¹¶åƒè¿™æ ·æ›´æ”¹æˆ‘ä»¬çš„`index.js`:

```diff
--- a/index.js
+++ b/index.js
@@ -4,12 +4,16 @@ import {unified} from 'unified'
 import remarkParse from 'remark-parse'
 import remarkSlug from 'remark-slug'
 import remarkToc from 'remark-toc'
+import remarkRetext from 'remark-retext'
+import retextEnglish from 'retext-english'
+import retextIndefiniteArticle from 'retext-indefinite-article'
 import remarkRehype from 'remark-rehype'
 import rehypeDocument from 'rehype-document'
 import rehypeStringify from 'rehype-stringify'

 const processor = unified()
   .use(remarkParse)
+  .use(remarkRetext, unified().use(retextEnglish).use(retextIndefiniteArticle))
   .use(remarkSlug)
   .use(remarkToc)
   .use(remarkRehype)
```

å¦‚ä»£ç æ‰€ç¤ºï¼Œ`remark-retext`æ¥æ”¶å¦ä¸€ä¸ª`unified`ä¸­é—´ä»¶ç®¡é“ã€‚
è‡ªç„¶è¯­è¨€ç®¡é“ã€‚
è¯¥æ’ä»¶å°†ä½¿ç”¨ç»™å®šç®¡é“çš„è§£æå™¨è½¬æ¢åŸå§‹è¯­æ³•ï¼ˆMarkdownï¼‰ã€‚
ç„¶åï¼Œå®ƒå°†åœ¨è‡ªç„¶è¯­è¨€è¯­æ³•æ ‘ä¸Šè¿è¡Œé™„åŠ çš„æ’ä»¶ã€‚

ç°åœ¨ï¼Œå½“æœ€åä¸€æ¬¡è¿è¡Œæˆ‘ä»¬çš„è„šæœ¬æ—¶ï¼š

```sh
$ node index.js
example.md
  7:1-7:2  warning  Use `An` before `example`, not `A`  retext-indefinite-article  retext-indefinite-article

âš  1 warning
```

â€¦æˆ‘ä»¬ä¼šæ”¶åˆ°ä¸€æ¡æœ‰ç”¨çš„ä¿¡æ¯ã€‚

ğŸ’ƒ
ä½ å·²ç»å»ºç«‹äº†ä¸€ä¸ªéå¸¸é…·çš„ç³»ç»Ÿï¼Œåšå¾—å¾ˆå¥½ï¼
è¿™æ˜¯ä¸€ä¸ªæ€»ç»“ï¼ŒæŸ¥çœ‹ä¸‹ä¸€èŠ‚çš„è¿›ä¸€æ­¥ç»ƒä¹ å’Œèµ„æºã€‚

### è¿›ä¸€æ­¥ç»ƒä¹ 

æœ€åï¼ŒæŸ¥çœ‹[retext][retext-plugins],[remark][remark-plugins], å’Œ [rehype][rehype-plugins]çš„å¯ç”¨æ’ä»¶åˆ—è¡¨ï¼Œå¹¶å°è¯•å…¶ä¸­ä¸€äº›ã€‚

å¦‚æœä½ è¿˜æ²¡æœ‰ï¼Œè¯·æŸ¥çœ‹[å­¦ä¹ éƒ¨åˆ†][learn]ä¸­çš„å…¶ä»–æ–‡ç« ï¼

[support]: https://github.com/unifiedjs/.github/blob/main/support.md
[parse]: https://github.com/remarkjs/remark/tree/HEAD/packages/remark-parse
[stringify]: https://github.com/rehypejs/rehype/tree/HEAD/packages/rehype-stringify
[remark-rehype]: https://github.com/remarkjs/remark-rehype
[npm]: https://www.npmjs.com
[node]: https://nodejs.org
[slug]: https://github.com/remarkjs/remark-slug
[toc]: https://github.com/remarkjs/remark-toc
[document]: https://github.com/rehypejs/rehype-document
[to-vfile]: https://github.com/vfile/to-vfile
[reporter]: https://github.com/vfile/vfile-reporter
[unified-stream]: https://github.com/unifiedjs/unified-stream
[english]: https://github.com/retextjs/retext/tree/HEAD/packages/retext-english
[indefinite-article]: https://github.com/retextjs/retext-indefinite-article
[remark-retext]: https://github.com/remarkjs/remark-retext
[retext-plugins]: https://github.com/retextjs/retext/blob/HEAD/doc/plugins.md
[remark-plugins]: https://github.com/remarkjs/remark/blob/HEAD/doc/plugins.md
[rehype-plugins]: https://github.com/rehypejs/rehype/blob/HEAD/doc/plugins.md
[rehype-raw]: https://github.com/rehypejs/rehype-raw
[rehype-format]: https://github.com/rehypejs/rehype-format
[learn]: /learn/
